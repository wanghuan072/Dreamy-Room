<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è·¯ç”±è°ƒè¯•å·¥å…·</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .debug-section {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .debug-section h2 {
            color: #333;
            margin-top: 0;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
        }
        .route-item {
            padding: 10px;
            margin: 5px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .route-path {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            color: #007bff;
        }
        .route-name {
            color: #666;
            font-size: 0.9em;
        }
        .test-btn {
            padding: 5px 10px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }
        .test-btn:hover {
            background-color: #218838;
        }
        .status {
            padding: 5px 10px;
            border-radius: 3px;
            font-size: 12px;
            margin-left: 10px;
        }
        .status.success {
            background-color: #d4edda;
            color: #155724;
        }
        .status.error {
            background-color: #f8d7da;
            color: #721c24;
        }
        .status.testing {
            background-color: #d1ecf1;
            color: #0c5460;
        }
        .current-info {
            background-color: #e9ecef;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
        }
        .current-info h3 {
            margin-top: 0;
            color: #495057;
        }
        .info-item {
            margin: 8px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
        .info-label {
            font-weight: bold;
            color: #6c757d;
        }
        .console-output {
            background-color: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <h1>ğŸ” Vue Router è°ƒè¯•å·¥å…·</h1>

    <div class="current-info">
        <h3>å½“å‰é¡µé¢ä¿¡æ¯</h3>
        <div class="info-item">
            <span class="info-label">URL:</span> <span id="current-url"></span>
        </div>
        <div class="info-item">
            <span class="info-label">è·¯å¾„:</span> <span id="current-path"></span>
        </div>
        <div class="info-item">
            <span class="info-label">Hash:</span> <span id="current-hash"></span>
        </div>
        <div class="info-item">
            <span class="info-label">Search:</span> <span id="current-search"></span>
        </div>
        <div class="info-item">
            <span class="info-label">æ—¶é—´:</span> <span id="current-time"></span>
        </div>
    </div>

    <div class="debug-section">
        <h2>ğŸ“‹ è·¯ç”±åˆ—è¡¨æµ‹è¯•</h2>
        <p>ç‚¹å‡»æµ‹è¯•æŒ‰é’®æ£€æŸ¥æ¯ä¸ªè·¯ç”±æ˜¯å¦æ­£å¸¸å·¥ä½œï¼š</p>
        <div id="routes-list"></div>
    </div>

    <div class="debug-section">
        <h2>ğŸš¨ é—®é¢˜è¯Šæ–­</h2>
        <button onclick="runDiagnostics()" style="padding: 10px 20px; background: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer; margin-bottom: 15px;">
            è¿è¡Œè¯Šæ–­
        </button>
        <div id="diagnostics-output" class="console-output"></div>
    </div>

    <div class="debug-section">
        <h2>ğŸ“ æ§åˆ¶å°æ—¥å¿—</h2>
        <button onclick="clearConsole()" style="padding: 5px 10px; background: #6c757d; color: white; border: none; border-radius: 3px; cursor: pointer; margin-bottom: 10px;">
            æ¸…ç©ºæ—¥å¿—
        </button>
        <div id="console-log" class="console-output"></div>
    </div>

    <script>
        // å®šä¹‰æ‰€æœ‰è·¯ç”±
        const routes = [
            { path: '/', name: 'home', component: 'HomeView.vue' },
            { path: '/levels', name: 'levels', component: 'LevelsView.vue' },
            { path: '/download', name: 'download', component: 'DownloadView.vue' },
            { path: '/blog', name: 'blog', component: 'BlogView.vue' },
            { path: '/blog/:addressBar', name: 'blog-detail', component: 'BlogDetailView.vue' },
            { path: '/levels/:addressBar', name: 'level-detail', component: 'LevelDetail.vue' },
            { path: '/privacy-policy', name: 'privacy-policy', component: 'PrivacyPolicyView.vue' },
            { path: '/terms-of-service', name: 'terms-of-service', component: 'TermsOfServiceView.vue' },
            { path: '/copyright', name: 'copyright', component: 'CopyrightView.vue' },
            { path: '/about-us', name: 'about-us', component: 'AboutUsView.vue' },
            { path: '/contact-us', name: 'contact-us', component: 'ContactUsView.vue' },
            { path: '/admin/sitemap', name: 'sitemap-manager', component: 'SitemapManagerView.vue' },
            { path: '/test/sitemap', name: 'test-sitemap', component: 'TestSitemapView.vue' },
            { path: '/:pathMatch(.*)*', name: 'notfound', component: 'NotFound.vue' }
        ];

        let consoleLog = [];

        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${type.toUpperCase()}: ${message}`;
            consoleLog.push(logEntry);
            updateConsoleDisplay();
        }

        function updateConsoleDisplay() {
            document.getElementById('console-log').textContent = consoleLog.join('\n');
        }

        function clearConsole() {
            consoleLog = [];
            updateConsoleDisplay();
        }

        function updateCurrentInfo() {
            document.getElementById('current-url').textContent = window.location.href;
            document.getElementById('current-path').textContent = window.location.pathname;
            document.getElementById('current-hash').textContent = window.location.hash || '(æ— )';
            document.getElementById('current-search').textContent = window.location.search || '(æ— )';
            document.getElementById('current-time').textContent = new Date().toLocaleString();
        }

        function renderRoutes() {
            const container = document.getElementById('routes-list');
            container.innerHTML = routes.map((route, index) => `
                <div class="route-item">
                    <div>
                        <span class="route-path">${route.path}</span>
                        <span class="route-name">(${route.name})</span>
                    </div>
                    <div>
                        <button class="test-btn" onclick="testRoute('${route.path}', ${index})">
                            æµ‹è¯•
                        </button>
                        <span id="status-${index}" class="status" style="display: none;"></span>
                    </div>
                </div>
            `).join('');
        }

        async function testRoute(path, index) {
            const statusEl = document.getElementById(`status-${index}`);
            statusEl.style.display = 'inline-block';
            statusEl.className = 'status testing';
            statusEl.textContent = 'æµ‹è¯•ä¸­...';

            log(`å¼€å§‹æµ‹è¯•è·¯ç”±: ${path}`);

            try {
                // å¯¹äºåŠ¨æ€è·¯ç”±ï¼Œä½¿ç”¨ç¤ºä¾‹è·¯å¾„
                let testPath = path;
                if (path.includes(':addressBar')) {
                    testPath = path.replace(':addressBar', 'test-example');
                }
                if (path.includes('pathMatch')) {
                    testPath = '/non-existent-page';
                }

                const response = await fetch(testPath);
                
                if (response.ok) {
                    const text = await response.text();
                    const isNotFound = text.includes('404') || text.includes('Page Not Found');
                    
                    if (isNotFound && !path.includes('pathMatch')) {
                        statusEl.className = 'status error';
                        statusEl.textContent = 'è·³è½¬åˆ°404';
                        log(`è·¯ç”± ${path} è·³è½¬åˆ°äº†404é¡µé¢`, 'error');
                    } else {
                        statusEl.className = 'status success';
                        statusEl.textContent = 'æ­£å¸¸';
                        log(`è·¯ç”± ${path} æµ‹è¯•æˆåŠŸ`, 'success');
                    }
                } else {
                    statusEl.className = 'status error';
                    statusEl.textContent = `é”™è¯¯ ${response.status}`;
                    log(`è·¯ç”± ${path} è¿”å›é”™è¯¯: ${response.status}`, 'error');
                }
            } catch (error) {
                statusEl.className = 'status error';
                statusEl.textContent = 'è¿æ¥å¤±è´¥';
                log(`è·¯ç”± ${path} æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function runDiagnostics() {
            const output = document.getElementById('diagnostics-output');
            output.textContent = 'æ­£åœ¨è¿è¡Œè¯Šæ–­...\n';

            const diagnostics = [];

            // æ£€æŸ¥åŸºæœ¬ä¿¡æ¯
            diagnostics.push('=== åŸºæœ¬ä¿¡æ¯ ===');
            diagnostics.push(`å½“å‰URL: ${window.location.href}`);
            diagnostics.push(`ç”¨æˆ·ä»£ç†: ${navigator.userAgent}`);
            diagnostics.push(`æ—¶é—´: ${new Date().toISOString()}`);
            diagnostics.push('');

            // æ£€æŸ¥å…³é”®è·¯ç”±
            diagnostics.push('=== å…³é”®è·¯ç”±æµ‹è¯• ===');
            const keyRoutes = ['/admin/sitemap', '/test/sitemap', '/'];
            
            for (const route of keyRoutes) {
                try {
                    const response = await fetch(route);
                    const text = await response.text();
                    const isNotFound = text.includes('404') || text.includes('Page Not Found');
                    
                    diagnostics.push(`${route}: ${response.status} ${isNotFound ? '(è·³è½¬åˆ°404)' : '(æ­£å¸¸)'}`);
                } catch (error) {
                    diagnostics.push(`${route}: é”™è¯¯ - ${error.message}`);
                }
            }

            diagnostics.push('');

            // æ£€æŸ¥APIç«¯ç‚¹
            diagnostics.push('=== APIç«¯ç‚¹æµ‹è¯• ===');
            const apiRoutes = ['/api/sitemap', '/api/sitemap-json'];
            
            for (const route of apiRoutes) {
                try {
                    const response = await fetch(route);
                    const contentType = response.headers.get('content-type');
                    diagnostics.push(`${route}: ${response.status} (${contentType})`);
                } catch (error) {
                    diagnostics.push(`${route}: é”™è¯¯ - ${error.message}`);
                }
            }

            diagnostics.push('');
            diagnostics.push('=== è¯Šæ–­å®Œæˆ ===');
            diagnostics.push('å¦‚æœ /admin/sitemap æ˜¾ç¤º"è·³è½¬åˆ°404"ï¼Œè¯´æ˜è·¯ç”±é…ç½®æˆ–ç»„ä»¶åŠ è½½æœ‰é—®é¢˜');
            diagnostics.push('è¯·æ£€æŸ¥:');
            diagnostics.push('1. src/views/SitemapManagerView.vue æ–‡ä»¶æ˜¯å¦å­˜åœ¨');
            diagnostics.push('2. ç»„ä»¶ä¸­çš„å¯¼å…¥æ˜¯å¦æœ‰é”™è¯¯');
            diagnostics.push('3. è·¯ç”±é…ç½®æ˜¯å¦æ­£ç¡®');

            output.textContent = diagnostics.join('\n');
        }

        // åˆå§‹åŒ–
        updateCurrentInfo();
        renderRoutes();
        setInterval(updateCurrentInfo, 1000);

        // è‡ªåŠ¨è¿è¡Œè¯Šæ–­
        setTimeout(runDiagnostics, 1000);

        log('è·¯ç”±è°ƒè¯•å·¥å…·å·²å¯åŠ¨');
    </script>
</body>
</html>